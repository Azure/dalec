# syntax=ghcr.io/azure/dalec/frontend:latest

name: sourcemap-test-testfail
description: Test spec with intentionally failing test to verify source maps
website: https://example.com
version: 1.0.0
revision: 1
vendor: Test
packager: Test Packager
license: MIT

# This spec is designed to fail during test execution
# to test that source maps correctly point to the failing test
build:
  steps:
    - command: |
        echo "Build completed successfully"

dependencies:
  test:
    bash: {}

x-tests: &test_steps
  - name: "command with bad output"
    steps:
      - command: /bin/sh -c "echo -n hello"
        stdout:
          contains:
            - "goodbye"
            - "whatever"
            - "hello"
          equals: hello1

  - name: passing-test
    steps:
      - command: /bin/sh -c "echo hello"
  - name: failing-test
    steps:
      - command: /another/nonexistent/command
      - command: /also/does/not/exist
  - name: missing files
    files:
      /bin/sh:
        not_exist: true
      /path/to/missing/file.txt: {}
      /path/to/missing/file2.txt:
        contains:
          - "hello!"


targets:
  azlinux3:
    tests: *test_steps
  noble:
    tests: *test_steps
