# syntax=local/dalec/frontend

name: dalec-test-systemd-unit
description: A test fixture which tests the installation of a simple systemd unit
website: https://www.github.com/Azure/dalec
version: 0.0.1
revision: 1
vendor: Microsoft
license: Apache 2.0
packager: Microsoft <support@microsoft.com>

targets:
  mariner2:
    image:
      base: mcr.microsoft.com/cbl-mariner/base/core:2.0

dependencies:
  build:
    msft-golang:
  runtime:
    bash:
    curl:
    systemd:

sources:
  src:
    context: {}
    path: test/fixtures/service
    includes: 
    - test/fixtures/service

build:
  steps:
    - command: |
        cd src/
        go build -o service main.go

artifacts:
  binaries:
    src/service: {}

  services:
    src/simple.service:
      # is the service enabled or disabled by default on boot
      # this determines what goes in the sytemctl preset file
      # disable: true
      # noRestart: false

image:
  # entrypoint: /bin/service
  entrypoint: /sbin/init
  stop_signal: SIGRTMIN+3
  user: root


  
