# syntax=ghcr.io/azure/dalec/frontend:latest

targets:
  mariner2:
    dependencies:
      runtime:

# https://dev.azure.com/AzureContainerUpstream/Support/_search?action=contents&text=xsignextension&type=code&lp=code-Project&filters=ProjectFilters%7BSupport%7DRepositoryFilters%7Bupstream-ado-image-builder%7D&pageSize=25&result=DefaultCollection/Support/upstream-ado-image-builder/GBmain//image-builder/mariner-preprovision.sh
sources:
  xsignextension:
    path: /usr
    image:
      ref: mcr.microsoft.com/azure-cli:cbl-mariner2.0
      cmd:
        steps:
          - command: |
              az config set extension.use_dynamic_install=yes_without_prompt
              az login --identity
              az storage blob download \
                --account-name upstreamaibartifacts \
                --container-name az-sign-extension \
                --name "versions/xsignextension-${XSIGNEXTENSION_VERSION}-py3-none-any.whl" \
                --file "xsignextension-${XSIGNEXTENSION_VERSION}-py3-none-any.whl" \
                --auth-mode login
              az extension add \
                -s xsignextension-${XSIGNEXTENSION_VERSION}-py3-none-any.whl \
                -y --system --debug

build:
          
    
      
